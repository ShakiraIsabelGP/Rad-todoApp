{"version":3,"sources":["com/fulcrologic/rad/control.cljc"],"mappings":"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","names":["options__56259__auto__","_","props","com.fulcrologic.fulcro.components/wrapped-render","com.fulcrologic.fulcro.components/props","js/com","js/com.fulcrologic","js/com.fulcrologic.rad","js/com.fulcrologic.rad.control","js/com.fulcrologic.rad.control.Control","com.fulcrologic.fulcro.components/react-constructor","cljs.core.get","com.fulcrologic.fulcro.components/configure-component!","com.fulcrologic.rad.control/Control","var_args","G__71423","com.fulcrologic.rad.control/render-control","js/Error","owner","control-key","com.fulcrologic.rad.control.render_control","com.fulcrologic.fulcro.components/component-options","control","cljs.core.not_EQ_","map__71424","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply","cljs.core/hash-map","runtime-atom","com.fulcrologic.fulcro.components/any->app","input-type","input-style","style->input","G__71426","cljs.core/deref","input","or__4126__auto__","G__71427","js/goog.DEBUG","taoensso.timbre.may_log_QMARK_","cljs.core/contains?","com.fulcrologic.rad.errors/prior-warnings","cljs.core.conj","taoensso.timbre._log_BANG_","taoensso.timbre/*config*","cljs.core/Delay","com.fulcrologic.rad.control/run!","com.fulcrologic.rad.options-util/debounce","instance","com.fulcrologic.fulcro.ui_state_machines.trigger_BANG_","com.fulcrologic.fulcro.components/get-ident","com.fulcrologic.rad.control/set-parameter","com.fulcrologic.fulcro.mutations/->Mutation","com.fulcrologic.fulcro.mutations/mutate","fulcro-mutation-env-symbol","map__71428","p__71430","map__71431","*after-render*-orig-val__71433","com.fulcrologic.fulcro.raw.components/*after-render*","*after-render*-temp-val__71434","env","*after-render*-orig-val__71437","*after-render*-temp-val__71438","temp__5735__auto__","com.fulcrologic.fulcro.algorithms.lookup/app-algorithm","default-action","k","value","component","ref","state","map__71435","options","track-in-url?","local?","cljs.core.get_in","id","cljs.core/second","path","com.fulcrologic.rad.routing.update_route_params_BANG_","cljs.core/assoc-in","cljs.core/assoc","cljs.core.swap_BANG_","com.fulcrologic.rad.control/set-parameter!","parameter-name","new-value","com.fulcrologic.fulcro.components.transact_BANG_","G__71439","com.fulcrologic.rad.control/control-map->controls","control-map","cljs.core/map?","cljs.core/reduce-kv","m","v","cljs.core.merge","com.fulcrologic.rad.control/current-value","map__71440","com.fulcrologic.fulcro.raw.application/current-state","G__71443","com.fulcrologic.rad.control/component-controls","class-or-instance","com.fulcrologic.rad.control.component_controls","recursive?","parent-controls","children","com.fulcrologic.rad.options_util.child_classes","cljs.core.reduce","controls","c","candidates","non-local-controls","cljs.core/not","cljs.core.assoc","cljs.spec.alpha/def-impl","cljs.spec.alpha.every_impl","G__71444","cljs.core/keyword?","cljs.core/vector?","G__71446","G__71445","cljs.spec.alpha/fspec-impl","cljs.spec.alpha.spec_impl","cljs.spec.alpha/cat-impl","cljs.spec.alpha/or-spec-impl","cljs.spec.alpha/map-spec-impl","G__71452","map__71453","G__71454","retspec71449","argspec71448","com.fulcrologic.guardrails.core/run-check","f71451","map__71456","map__71457","p__71460","vec__71461","cljs.core.nth","p__71464","vec__71465","cljs.core/PersistentVector","p1__71447#","ret71450","com.fulcrologic.rad.control/standard-control-layout","com.fulcrologic.fulcro.components/component-class?","com.fulcrologic.fulcro.components/component?","control-layout","action-buttons","inputs","control-button-keys","cljs.core/vec","cljs.core.keep","cljs.core._EQ_","input-keys","button-layout","input-layout","cljs.core.into","expected-layout-keys","cljs.core.filter","cljs.core/val","com.fulcrologic.rad.options_util._QMARK__BANG_","cljs.core.map","cljs.core/key","cljs.core/set","actual-layout-keys","cljs.core.disj","cljs.core/flatten","cljs.core/seq"],"sourcesContent":["(ns com.fulcrologic.rad.control\n  \"Controls are buttons and inputs in the UI that are not backed by model data, but instead\n   control things like report parameters or provide action buttons. This namespace provides\n   functions to help with UI plugin development, and other functions that reduce the amount\n   of boilerplate data when declaring controls.\n\n   A typical control is added to a component by adding a ::control/controls key, which\n   is a map from made-up control key to a control definition map.\n\n   ```\n   (defsc-form Form [this props]\n     {::control/controls {::new {:type :button\n                                 :label \\\"Go\\\"\n                                 :action (fn [this] ...)}}})\n   ```\n\n   Render plugins can then expose layout keys that allow you to place the controls. For example as action\n   buttons. See ::form/action-buttons.\n   \"\n  (:refer-clojure :exclude [run!])\n  (:require\n    [clojure.spec.alpha :as s]\n    [com.fulcrologic.guardrails.core :refer [>defn >def => ?]]\n    [com.fulcrologic.fulcro.components :as comp :refer [defsc]]\n    [com.fulcrologic.fulcro.mutations :refer [defmutation]]\n    [com.fulcrologic.fulcro.ui-state-machines :as uism]\n    [com.fulcrologic.fulcro.raw.application :as raw.app]\n    [com.fulcrologic.rad.routing :as rad-routing]\n    [com.fulcrologic.rad.errors :refer [warn-once!]]\n    [com.fulcrologic.rad.options-util :as opts :refer [?! debounce child-classes]]\n    [com.fulcrologic.rad :as rad]\n    [taoensso.encore :as enc]\n    [taoensso.timbre :as log]))\n\n(defsc Control\n  \"A component used for normalizing control state in the app so that reports in containers can share controls.\"\n  [_ _]\n  {:query [::id ::value]\n   :ident ::id})\n\n(defn render-control\n  \"Render the control defined by `control-key` in the ::report/controls option. The control definition in question will be\n   a `(fn [props])` where `props` is a map containing:\n\n   * `owner` - The React instance of the mounted component where the controls will be shown.\n   * `control-key` - The name of the control key being rendered .\n   \"\n  ([owner control-key]\n   (render-control owner control-key (get (comp/component-options owner ::controls) control-key)))\n  ([owner control-key control]\n   (when (not= control-key :_)\n     (let [{:com.fulcrologic.fulcro.application/keys [runtime-atom]} (comp/any->app owner)\n           input-type   (get control :type)\n           input-style  (get control :style :default)\n           style->input (some-> runtime-atom deref ::rad/controls ::type->style->control (get input-type))\n           input        (or (get style->input input-style) (get style->input :default))]\n       (if input\n         (input {:instance    owner\n                 :control     control\n                 :control-key control-key})\n         (when (and (not= input-type :none) #?(:cljs goog.DEBUG :clj true))\n           (warn-once! \"NOTE: No renderer is installed to support control \" control-key \"with type/style\" input-type input-style)\n           nil))))))\n\n(def run!\n  \"[this]\n\n   Run the controlled content with the current values of the controlled parameters.\"\n  (debounce\n    (fn [instance]\n      (uism/trigger! instance (comp/get-ident instance) :event/run))\n    100))\n\n(defmutation set-parameter [{:keys [k value]}]\n  (action [{:keys [component ref state]}]\n    (let [options       (comp/component-options component)\n          track-in-url? (get options :com.fulcrologic.rad.report/track-in-url? true)\n          {:keys [local?]} (get-in options [::controls k])\n          id            (second ref)\n          path          (if local? (conj ref :ui/parameters k) [::id k ::value])]\n      (when-not (false? track-in-url?)\n        (if local?\n          (rad-routing/update-route-params! component assoc-in [id k] value)\n          (rad-routing/update-route-params! component assoc k value)))\n      (swap! state assoc-in path value))))\n\n(defn set-parameter!\n  \"Set the given parameter on a report or container.\"\n  [instance parameter-name new-value]\n  (comp/transact! instance [(set-parameter {:k parameter-name :value new-value})]))\n\n(defn control-map->controls\n  \"Convert an old-style control map into a vector of controls that can be normalized into state as `Control`s.\"\n  [control-map]\n  (if (map? control-map)\n    (reduce-kv\n      (fn [m k v]\n        (conj m (merge {::id k} v)))\n      []\n      control-map)\n    control-map))\n\n(defn current-value\n  \"Get the current value of a control. If it is normalized, then it will come from the normalized table. If the control\n   is local to the instance, then it will come from there.\"\n  [instance control-key]\n  (let [{:keys [local?]} (get (comp/component-options instance ::controls) control-key)]\n    (if local?\n      (get-in (comp/props instance) [:ui/parameters control-key])\n      (-> instance\n        (raw.app/current-state)\n        (get-in [::id control-key ::value])))))\n\n(defn component-controls\n  \"Gets all of the controls declared on the given class or instance (e.g. report, container).\n   If `recursive?` (default true) is true, then it will look for non-local controls on all classes contained in the (recursive)\n   query of that class or instance. Controls appearing in the target `class-or-instance` will override any from children,\n   but any duplicates found in children will be unified by choosing an arbitrary one. Thus, if your component is pulling\n   unifying inconsistent controls from children you should probably provide a hand-unified control in the parent.\"\n  ([class-or-instance]\n   (component-controls class-or-instance true))\n  ([class-or-instance recursive?]\n   (let [parent-controls (comp/component-options class-or-instance ::controls)\n         children        (when recursive? (child-classes class-or-instance true))]\n     (merge\n       (reduce\n         (fn [controls c]\n           (let [candidates         (comp/component-options c ::controls)\n                 non-local-controls (reduce-kv\n                                      (fn [m k v]\n                                        (if (and (map? v) (not (:local? v)))\n                                          (assoc m k v)\n                                          m))\n                                      {}\n                                      candidates)]\n             (merge controls non-local-controls)))\n         {}\n         children)\n       ;; parent always wins\n       parent-controls))))\n\n(>def ::action-layout (s/coll-of keyword? :kind vector?))\n(>def ::input-layout (s/coll-of (s/coll-of keyword? :kind vector?) :kind vector?))\n\n(>defn standard-control-layout\n  \"Returns a map of:\n\n  * `:action-layout`: a simple vector of keywords for the order buttons should appear. The default is the order they\n    are returned from the control map (which is stable, but not necessarily the order of appearance in the map).\n  * `:input-layout`: a nested vector of keywords that represents the preferred layout of the controls\n     on `class-or-instance`. This layout can be declared on the class-or-instance, or will default to a\n     single-row layout based on the entry order in the control map (stable but undefined).\"\n  [class-or-instance]\n  [(s/or :cls comp/component-class? :inst comp/component?) => (s/keys :req-un [::action-layout ::input-layout])]\n  (let [{::keys [control-layout]} (comp/component-options class-or-instance)\n        ;; For backward compat with report option\n        control-layout (or control-layout (comp/component-options class-or-instance :com.fulcrologic.rad.report/control-layout))\n        {:keys [action-buttons inputs]} control-layout]\n    (let [controls            (component-controls class-or-instance)\n          control-button-keys (vec (keep (fn [[k v]] (when (= :button (:type v)) k)) controls))\n          input-keys          (keep (fn [[k v]] (when-not (= :button (:type v)) k)) controls)\n          button-layout       (or action-buttons control-button-keys)\n          input-layout        (or inputs (vector (into [] input-keys)))]\n      (when #?(:cljs js/goog.DEBUG :clj true)\n        (let [expected-layout-keys (->> controls\n                                     (filter #(-> (val %)\n                                                (get :visible? true)\n                                                (?! class-or-instance)))\n                                     (map key)\n                                     set)\n              actual-layout-keys   (disj\n                                     (into (set button-layout) (filter keyword?) (flatten input-layout))\n                                     :_)]\n          (when (and (seq expected-layout-keys) (not= expected-layout-keys actual-layout-keys))\n            (log/debug \"The control layout does not include all controls: \"\n              expected-layout-keys \"vs.\" actual-layout-keys))))\n      {:action-layout button-layout\n       :input-layout  input-layout})))\n"]}