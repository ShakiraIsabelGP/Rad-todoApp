{"version":3,"sources":["taoensso/tufte/stats.cljc"],"mappings":"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","names":["this__4369__auto__","writer__4370__auto__","opt__4371__auto__","cljs.core/-write","taoensso.tufte.stats/SortedLongs","taoensso.tufte.stats/->SortedLongs","a","_","taoensso.tufte.stats/sorted-longs?","x","taoensso.tufte.stats/sort-longs","longs","cljs.core/array?","cljs.core/to-array","goog.array/sort","taoensso.tufte.stats/long-percentiles","max-idx","Math/round","taoensso.tufte.stats/MinMax","taoensso.tufte.stats/->MinMax","vmin","vmax","taoensso.tufte.stats/min-max","cljs.core/count","vec__89495","cljs.core.nth","v1","min-max","cljs.core.reduce","acc","in","taoensso.tufte.stats/stats","sorted-longs","n","vec__89498","sum","a__4610__auto__","l__4611__auto__","i","mean","mad-sum","Math/abs","mad","p25","p50","p75","p90","p95","p99","taoensso.tufte.stats/merge-stats","m0","m1","map__89505","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply","cljs.core/hash-map","cljs.core.get","map__89506","js/Error","n0","min0","max0","sum0","mad-sum0","p25-0","p50-0","p75-0","p90-0","p95-0","p99-0","n1","min1","max1","sum1","mad-sum1","p25-1","p50-1","p75-1","p90-1","p95-1","p99-1","n2","n0-ratio","n1-ratio","sum2","mean2","min2","max2","mad-sum2","p25-2","p50-2","p75-2","p90-2","p95-2","p99-2","mad2","taoensso.tufte.stats/perc","d","round2","taoensso.encore/round2","taoensso.tufte.stats/fmt","nanosecs","ns","G__89510","G__89512","G__89514","G__89516","taoensso.tufte.stats/fmt-comma","cljs.core/reverse","cljs.core.partition","cljs.core.map","clojure.string/join","clojure.string.join","clojure.string/reverse","taoensso.tufte.stats/all-format-columns","taoensso.tufte.stats/default-format-columns","taoensso.tufte.stats/default-format-id-fn","id","p__89517","map__89518","taoensso.tufte.stats/get-max-id-width","stats","format-id-fn","cljs.core/reduce-kv","k","v","c","p__89520","map__89521","taoensso.tufte.stats/format-stats","clock-total","id-stats","columns","sort-fn","max-id-width","opts","m","taoensso.truss.impl/revery?","__in","e","cljs.core/contains?","taoensso.truss.impl/set*","taoensso.truss.impl/-dummy-error","e89523","taoensso.truss.impl/-invar-violation!","cljs.core/long","accounted-total","_id","s","sorted-ids","cljs.core.sort_by","G__89524","taoensso.encore/rcompare","cljs.core/keys","or__4126__auto__","column->pattern","sb","taoensso.encore.str_builder","append-col","column","map__89525","min-width","align","taoensso.encore.sb_append","taoensso.encore.format","G__89528","cljs.core/Keyword","seq__89529","cljs.core/seq","chunk__89530","count__89531","i__89532","temp__5735__auto__","cljs.core/chunked-seq?","c__4556__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/first","cljs.core/next","cljs.core.into","cljs.core._EQ_","cljs.core.get_in","seq__89533","chunk__89534","count__89535","i__89536","seq__89579","chunk__89580","count__89581","i__89582","seq__89587","chunk__89588","count__89589","i__89590","G__89585","G__89586","G__89593","G__89594","seq__89595","chunk__89596","count__89597","i__89598","G__89601","G__89602","seq__89603","chunk__89604","count__89605","i__89606","G__89609","G__89610"],"sourcesContent":["(ns taoensso.tufte.stats\n  \"Basic stats utils. Private, subject to change.\"\n  (:require [taoensso.encore :as enc]\n            [clojure.string  :as str]\n   #?(:cljs [goog.array])))\n\n(comment\n  (do\n    (defn rand-vs [n & [max]] (take n (repeatedly (partial rand-int (or max Integer/MAX_VALUE)))))\n    (def v1 (rand-vs 1e5))\n    (def v1-sorted (sort-longs v1))))\n\n#?(:clj (def ^:const longs-class (Class/forName \"[J\")))\n#?(:clj (defn- longs? [x] (instance? longs-class x)))\n(comment (longs? (long-array 10)))\n\n(deftype SortedLongs [^longs a]\n  #?@(:clj  [clojure.lang.Counted  (count [_] (alength a))]\n      :cljs [            ICounted (-count [_] (alength a))]))\n\n(defn sorted-longs? [x] (instance? SortedLongs x))\n(defn sort-longs ^SortedLongs [longs]\n  (if (sorted-longs? longs)\n    longs\n    #?(:cljs\n       (let [a (if (array? longs) longs (to-array longs))]\n         (goog.array/sort a)\n         (SortedLongs. a))\n\n       :clj\n       (let [^longs a (if (longs? longs) longs (long-array longs))]\n         (java.util.Arrays/sort a) ; O(n.log(n)) on JDK 7+\n         (SortedLongs. a)))))\n\n(comment\n  (vec (.-a (sort-longs nil)))\n  (vec (.-a (sort-longs [])))\n  (vec (.-a (sort-longs (rand-vs 10)))))\n\n(defn long-percentiles\n  \"Returns ?[min p25 p50 p75 p90 p95 p99 max]\"\n  [longs]\n  (let [^longs a (.-a (sort-longs longs))\n        max-idx (dec (alength a))]\n    (if (< max-idx 0)\n      nil\n      [(aget a 0)\n       (aget a (Math/round (* 0.25 max-idx)))\n       (aget a (Math/round (* 0.50 max-idx)))\n       (aget a (Math/round (* 0.75 max-idx)))\n       (aget a (Math/round (* 0.90 max-idx)))\n       (aget a (Math/round (* 0.95 max-idx)))\n       (aget a (Math/round (* 0.99 max-idx)))\n       (aget a                     max-idx)])))\n\n(comment\n  (long-percentiles nil)\n  (long-percentiles [])\n  (enc/qb 100\n    (long-percentiles v1)\n    (long-percentiles v1-sorted)) ; [1580.76 0.02]\n  )\n\n(deftype MinMax [^long vmin ^long vmax])\n(defn min-max \"Returns ?[<min> <max>]\" [longs]\n  (if (sorted-longs? longs)\n    (let [^longs a (.-a ^SortedLongs longs)\n          max-idx (dec (alength a))]\n      (if (< max-idx 0)\n        nil\n        [(aget a 0) (aget a max-idx)]))\n\n    (if (zero? (count longs))\n      nil\n      (let [[v1] longs\n            ^MinMax min-max\n            (reduce\n              (fn [^MinMax acc ^long in]\n                (let [vmin (.-vmin acc)\n                      vmax (.-vmax acc)]\n                  (if (> in vmax)\n                    (MinMax. vmin in)\n                    (if (< in vmin)\n                      (MinMax. in vmin)\n                      acc))))\n              (MinMax. v1 v1)\n              longs)]\n        [(.-vmin min-max) (.-vmax min-max)]))))\n\n(comment (enc/qb 1e6 (min-max [10 9 -3 12]))) ; 267.25\n\n(comment\n  (let [a (long-array v1)]\n    (enc/qb 1e2\n      (reduce (fn [^long acc ^long in] (unchecked-add acc in)) v1)\n      (areduce a idx ret 0 (unchecked-add ret (aget a idx))))))\n\n(defn stats\n  \"Given a collection of longs, returns map with keys:\n  #{:n :min :max :sum :mean :mad-sum :mad :p25 :p50 :p75 :p90 :p95 :p99}, or nil\n  if collection is empty.\"\n  [longs]\n  (when longs\n    (let [sorted-longs (sort-longs longs)\n          ^longs a (.-a sorted-longs)\n          n (alength a)]\n      (if (zero? n)\n        nil\n        (let [sum     (areduce a i acc 0 (+ acc (aget a i)))\n              mean    (/ (double sum) (double n))\n              mad-sum (areduce a i acc 0.0 (+ acc (Math/abs (- (double (aget a i)) mean))))\n              mad     (/ (double mad-sum) (double n))\n\n              [vmin p25 p50 p75 p90 p95 p99 vmax] (long-percentiles sorted-longs)]\n\n          {:n n :min vmin :max vmax :sum sum :mean mean\n           :mad-sum mad-sum :mad mad\n           :p25 p25 :p50 p50 :p75 p75\n           :p90 p90 :p95 p95 :p99 p99})))))\n\n(comment (enc/qb 100 (stats v1) (stats v1-sorted))) ; [1604.23 38.3]\n\n(defn merge-stats\n  \"`(merge-stats (stats c0) (stats c1))` is a basic approximation of `(stats (into c0 c1)))`.\"\n  [m0 m1]\n  (if m0\n    (if m1\n      (let [_ (assert (get m0 :n))\n            _ (assert (get m1 :n))\n\n            {^long   n0       :n\n             ^long   min0     :min\n             ^long   max0     :max\n             ^long   sum0     :sum\n             ^double mad-sum0 :mad-sum\n             ^long   p25-0    :p25\n             ^long   p50-0    :p50\n             ^long   p75-0    :p75\n             ^long   p90-0    :p90\n             ^long   p95-0    :p95\n             ^long   p99-0    :p99} m0\n\n            {^long   n1       :n\n             ^long   min1     :min\n             ^long   max1     :max\n             ^long   sum1     :sum\n             ^double mad-sum1 :mad-sum\n             ^long   p25-1    :p25\n             ^long   p50-1    :p50\n             ^long   p75-1    :p75\n             ^long   p90-1    :p90\n             ^long   p95-1    :p95\n             ^long   p99-1    :p99} m1\n\n            _ (assert (pos? n0))\n            _ (assert (pos? n1))\n\n            n2       (+ n1 n0)\n            n0-ratio (/ (double n0) (double n2))\n            n1-ratio (/ (double n1) (double n2))\n\n            sum2  (+ sum0 sum1)\n            mean2 (/ (double sum2) (double n2))\n            min2  (if (< min0 min1) min0 min1)\n            max2  (if (> max0 max1) max0 max1)\n\n            ;; Batched \"online\" MAD calculation here is better= the standard\n            ;; Knuth/Welford method, Ref. http://goo.gl/QLSfOc,\n            ;;                            http://goo.gl/mx5eSK.\n            ;;\n            ;; Note that there's empirically no advantage in using `mean2` here\n            ;; asap, i.e. to reducing (- v1_i mean2).\n            mad-sum2 (+ mad-sum0 ^double mad-sum1)\n\n            ;;; These are pretty rough approximations. More sophisticated\n            ;;; approaches not worth the extra cost/effort in our case.\n            p25-2 (Math/round (+ (* n0-ratio (double p25-0)) (* n1-ratio (double p25-1))))\n            p50-2 (Math/round (+ (* n0-ratio (double p50-0)) (* n1-ratio (double p50-1))))\n            p75-2 (Math/round (+ (* n0-ratio (double p75-0)) (* n1-ratio (double p75-1))))\n            p90-2 (Math/round (+ (* n0-ratio (double p90-0)) (* n1-ratio (double p90-1))))\n            p95-2 (Math/round (+ (* n0-ratio (double p95-0)) (* n1-ratio (double p95-1))))\n            p99-2 (Math/round (+ (* n0-ratio (double p99-0)) (* n1-ratio (double p99-1))))\n\n            mad2 (/ (double mad-sum2) (double n2))]\n\n        {:n n2 :min min2 :max max2 :sum sum2 :mean mean2\n         :mad-sum mad-sum2 :mad mad2\n         :p25 p25-2 :p50 p50-2 :p75 p75-2\n         :p90 p90-2 :p95 p95-2 :p99 p99-2})\n      m0)\n    m1))\n\n(comment\n  (def v2 [1 2 2 3 2 1])\n  (def v3 [1 3 5 2 1 6])\n  (def v4 (into v2 v3))\n\n  (stats v2) {:min 1, :mean 1.8333333333333333, :mad-sum 3.333333333333333,  :p99 3, :n 6,  :p90 3, :max 3, :mad 0.5555555555555555, :p50 2, :sum 11, :p95 3}\n  (stats v3) {:min 1, :mean 3.0,                :mad-sum 10.0,               :p99 6, :n 6,  :p90 6, :max 6, :mad 1.6666666666666667, :p50 3, :sum 18, :p95 6}\n  (stats v4) {:min 1, :mean 2.4166666666666665, :mad-sum 14.666666666666666, :p99 6, :n 12, :p90 5, :max 6, :mad 1.222222222222222,  :p50 2, :sum 29, :p95 5}\n\n  (merge-stats (stats v2) (stats v3))\n  {:min 1, :mean 2.4166666666666665, :mad-sum 13.333333333333332, :p99 5, :n 12, :p90 5, :max 6, :mad 1.111111111111111, :p50 3, :sum 29, :p95 5}\n\n  (stats (stats v2) v3)\n  {:min 1, :mean 2.4166666666666665, :mad-sum 13.333333333333332, :p99 5, :n 12, :p90 5, :max 6, :mad 1.111111111111111, :p50 3, :sum 29, :p95 5}\n\n  (merge-stats (stats v2) (stats v2))\n  {:min 1, :mean 1.8333333333333333, :mad-sum 6.666666666666666, :p99 3, :n 12, :p90 3, :max 3, :mad 0.5555555555555555, :p50 2, :sum 22, :p95 3}\n\n  (let [v1 (rand-vs 1e5 80)\n        v2 (rand-vs 1e5 20)\n        v3 (into v1 v2)]\n    (mapv :mad\n      [(stats v1)\n       (stats v2)\n       (stats v3)\n       (merge-stats (stats v1) (stats v2))\n       (stats (stats v1) v2)]))\n\n  [19.943705799999858 5.015891904000014 18.906570458826117 12.479798851999936 12.479798851999936]\n  [20.033054674800002 5.013648978000108 18.914174079741983 12.523351826400054 12.523351826400054])\n\n;;;; Formatting\n\n(defn- perc [n d] (str (Math/round (* (/ (double n) (double d)) 100.0)) \"%\"))\n(comment [(perc 1 1) (perc 1 100) (perc 12 44)])\n\n(let [round2 #?(:cljs enc/round2 :clj (fn [n] (format \"%.2f\" n)))]\n  (defn- fmt [nanosecs]\n    (let [ns (double nanosecs)]\n      (cond\n        (>= ns 6e10) (str (round2 (/ ns 6e10)) \"m \")\n        (>= ns 1e9)  (str (round2 (/ ns 1e9))  \"s \")\n        (>= ns 1e6)  (str (round2 (/ ns 1e6))  \"ms\")\n        (>= ns 1e3)  (str (round2 (/ ns 1e3))  \"\u03bcs\")\n        :else        (str (round2    ns)       \"ns\")))))\n\n(comment\n  (format \"%.2f\" 40484.005)\n  (fmt 2387387870))\n\n(defn- fmt-comma [^long n]\n  (str\n    (when (neg? n) \"-\")\n    (->> (str (Math/abs n))\n         (reverse)\n         (partition 3 3 \"\")\n         (map str/join)\n         (str/join \",\")\n         (str/reverse))))\n\n(def     all-format-columns [:n-calls :min   :p25 :p50   :p75 :p90 :p95 :p99 :max :mean :mad :clock :total])\n(def default-format-columns [:n-calls :min #_:p25 :p50 #_:p75 :p90 :p95 :p99 :max :mean :mad :clock :total])\n\n(def default-format-id-fn (fn [id] (str id)))\n\n(defn get-max-id-width [stats {:keys [format-id-fn]\n                               :or   {format-id-fn default-format-id-fn}}]\n  (when stats\n     (reduce-kv\n       (fn [^long acc k v]\n           (let [c (count (format-id-fn k))]\n                (if (> c acc) c acc)))\n       9 ; (count \"Accounted\")\n       stats)))\n\n(defn format-stats\n  \"Returns a formatted table string for given `{<id> <stats>}` map.\n  Assumes nanosecond clock, stats based on profiling id'd nanosecond times.\"\n  [clock-total id-stats {:keys [columns sort-fn format-id-fn max-id-width] :as opts\n                         :or   {columns      default-format-columns\n                                sort-fn      (fn [m] (get m :sum))\n                                format-id-fn default-format-id-fn}}]\n  (when id-stats\n    (enc/have? [:el all-format-columns] :in columns)\n    (let [clock-total (long clock-total)\n          ^long accounted-total\n          (reduce-kv\n            (fn [^long acc _id s]\n              (+ acc (long (get s :sum))))\n            0 id-stats)\n\n          sorted-ids\n          (sort-by\n            (fn [id] (sort-fn (get id-stats id)))\n            enc/rcompare\n            (keys id-stats))\n\n          ^long max-id-width (or max-id-width (get-max-id-width id-stats opts))\n\n          column->pattern\n          {:id      {:heading \"pId\"    :min-width max-id-width :align :left}\n           :n-calls {:heading \"nCalls\"}\n           :min     {:heading \"Min\"}\n           :p25     {:heading \"25% \u2264\"}\n           :p50     {:heading \"50% \u2264\"}\n           :p75     {:heading \"75% \u2264\"}\n           :p90     {:heading \"90% \u2264\"}\n           :p95     {:heading \"95% \u2264\"}\n           :p99     {:heading \"99% \u2264\"}\n           :max     {:heading \"Max\"}\n           :mean    {:heading \"Mean\"}\n           :mad     {:heading \"MAD\"   :min-width 5}\n           :total   {:heading \"Total\" :min-width 6}\n           :clock   {:heading \"Clock\"}}\n\n          sb (enc/str-builder \"\")\n\n          append-col\n          (fn [column s]\n            (let [{:keys [min-width align]\n                   :or   {min-width 10 align :right}}\n                  (get column->pattern column)]\n\n              (enc/sb-append sb\n                (enc/format\n                  (str \"%\" (case align :left \"-\" :right \"\") min-width \"s\")\n                  s))))]\n\n      ; Write header rows\n      (doseq [column (into [:id] columns)]\n        (when-not (= :id column)\n          (enc/sb-append sb \" \"))\n        (append-col column (get-in column->pattern [column :heading])))\n\n      (enc/sb-append sb \"\\n\\n\")\n\n      ; Write id rows\n      (doseq [id sorted-ids]\n        (let [s (get id-stats id)\n              sum  (get s :sum)\n              mean (get s :mean)]\n\n          (append-col :id (format-id-fn id))\n          (doseq [column columns]\n            (enc/sb-append sb \" \")\n            (case column\n              :n-calls (append-col column (fmt-comma (get s :n)))\n              :mean    (append-col column (fmt mean))\n              :mad     (append-col column (str \"\u00b1\" (perc (get s :mad) mean)))\n              :total   (append-col column (perc sum clock-total))\n              :clock   (append-col column (fmt sum))\n              (do      (append-col column (fmt (get s column))))))\n\n          (enc/sb-append sb \"\\n\")))\n\n      ; Write accounted row\n      (enc/sb-append sb \"\\n\")\n      (append-col :id \"Accounted\")\n      (doseq [column columns]\n        (enc/sb-append sb \" \")\n        (case column\n          :total (append-col column (perc accounted-total clock-total))\n          :clock (append-col column (fmt accounted-total))\n          (do    (append-col column \"\"))))\n\n      ; Write clock row\n      (enc/sb-append sb \"\\n\")\n      (append-col :id \"Clock\")\n      (doseq [column columns]\n        (enc/sb-append sb \" \")\n        (case column\n          :total (append-col column \"100%\")\n          :clock (append-col column (fmt clock-total))\n          (do    (append-col column \"\"))))\n\n      (enc/sb-append sb \"\\n\")\n      (str sb))))\n\n(comment\n  (println\n    (format-stats (* 1e6 30)\n      {:foo (stats (rand-vs 1e4 20))\n       :bar (stats (rand-vs 1e2 50))\n       :baz (stats (rand-vs 1e5 30))}) \"\\n\"))\n"]}